{
    "repository": "git@github.com:openmdao/OpenMDAO",

    "triggers": [
        "git@github.com:mdolab/pyoptsparse/releases"
    ],

    "preinstall": [
        "unset USE_PROC_FILES"
    ],

    "conda": [
        "python=3",
        "gfortran=12",
        "numpy",
        "scipy"
    ],

    "conda-forge": [
        "mpi4py",
        "petsc4py"
    ],

    "dependencies": [
        "psutil",
        "objgraph",
        "git+https://github.com/mdolab/pyxdsm",
        "jaxlib"
    ],

    "extras": "[all]",

    "postinstall": [
        "export LATEST_URL=`curl -fsSLI -o /dev/null -w %{url_effective} https://github.com/mdolab/pyoptsparse/releases/latest`",
        "export LATEST_VER=`echo $LATEST_URL | awk '{split($0,a,\"/tag/\"); print a[2]}'`",
        "echo ~/dev/build_pyoptsparse/build_pyoptsparse.sh -b $LATEST_VER -p `pwd` -s ~/dev/snopt7/src",
        "~/dev/build_pyoptsparse/build_pyoptsparse.sh -b $LATEST_VER -p `pwd` -s ~/dev/snopt7/src",
        "export IPOPT_INC=`pwd`/include/coin-or",
        "export IPOPT_LIB=`pwd`/lib",
        "export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:`pwd`/lib"
    ],

    "notify": [
        "!subteam^S01PJ2C9GPN"
    ]
}
